(function(e){function t(t){for(var a,i,c=t[0],s=t[1],u=t[2],d=0,l=[];d<c.length;d++)i=c[d],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&l.push(o[i][0]),o[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);f&&f(t);while(l.length)l.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(a=!1)}a&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},i={app:0},o={app:0},r=[];function c(e){return s.p+"static/js/"+({}[e]||e)+"."+{"chunk-1114143e":"eccb6ca9","chunk-0f16cdb2":"c7dcc23c","chunk-0f8a37f6":"76cbd730"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-1114143e":1,"chunk-0f16cdb2":1,"chunk-0f8a37f6":1};i[e]?t.push(i[e]):0!==i[e]&&n[e]&&t.push(i[e]=new Promise((function(t,n){for(var a="static/css/"+({}[e]||e)+"."+{"chunk-1114143e":"4955ce76","chunk-0f16cdb2":"c1a0c60e","chunk-0f8a37f6":"ea99ea85"}[e]+".css",o=s.p+a,r=document.getElementsByTagName("link"),c=0;c<r.length;c++){var u=r[c],d=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(d===a||d===o))return t()}var l=document.getElementsByTagName("style");for(c=0;c<l.length;c++){u=l[c],d=u.getAttribute("data-href");if(d===a||d===o)return t()}var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.onload=t,f.onerror=function(t){var a=t&&t.target&&t.target.src||o,r=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete i[e],f.parentNode.removeChild(f),n(r)},f.href=o;var m=document.getElementsByTagName("head")[0];m.appendChild(f)})).then((function(){i[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var r=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=r);var u,d=document.createElement("script");d.charset="utf-8",d.timeout=120,s.nc&&d.setAttribute("nonce",s.nc),d.src=c(e);var l=new Error;u=function(t){d.onerror=d.onload=null,clearTimeout(f);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+a+": "+i+")",l.name="ChunkLoadError",l.type=a,l.request=i,n[1](l)}o[e]=void 0}};var f=setTimeout((function(){u({type:"timeout",target:d})}),12e4);d.onerror=d.onload=u,document.head.appendChild(d)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],d=u.push.bind(u);u.push=t,u=u.slice();for(var l=0;l<u.length;l++)t(u[l]);var f=d;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},4360:function(e,t,n){"use strict";var a=n("2b0e"),i=n("2f62"),o=(n("498a"),n("d3b7"),n("a78e")),r=n.n(o),c=n("5c96"),s=n("7ded"),u=n("5f87"),d=(n("25f0"),n("3452"));function l(e,t){var n=d.AES.encrypt(t,d.enc.Utf8.parse(e),{mode:d.mode.ECB,padding:d.pad.Pkcs7}).toString();return n}var f={state:{userId:"",isLogin:!1,isFull:!1,disabledState:!1},mutations:{SET_USERID:function(e,t){e.userId=t},SETISLOGIN:function(e,t){e.isLogin=t},SET_ISFULL:function(e,t){e.isFull=t},SET_DISABLEDSTATE:function(e,t){e.disabledState=t}},actions:{Login:function(e,t){var n=e.dispatch,a=e.commit,i=t.username.trim(),o=l(t.password.trim()),u=t.type,d=t.vertify_code;return new Promise((function(e,t){Object(s["c"])(i,o,u,d).then((function(i){a("SET_USERID",i.data.userid),r.a.set("logintoken",i.data.token),i.data.loingLock||i.data.loginLongTerm||i.data.loginFaild?t(i):(i.data.loginTip&&Object(c["Message"])({message:i.data.loginTip,type:"warning"}),n("GetAccessToken").then((function(){e()})).catch((function(e){t(e)})))})).catch((function(e){t(e)}))}))},GetAccessToken:function(e){var t=e.state;e.commit;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;setTimeout((function(){Object(s["a"])().then((function(e){if(0===e.code){Object(u["c"])(e.data.token);var t=(new Date).getTime(),a=e.data.timestamp;a<t&&(a*=1e3);var i=a-t-6e4;n(i)}}))}),e)}var a=new Promise((function(e,a){Object(s["a"])().then((function(a){if(0===a.code){t.isLogin=!0,Object(u["c"])(a.data.token);var i=(new Date).getTime(),o=a.data.timestamp;o<i&&(o*=1e3);var r=o-i-6e4;n(r)}e()}))}));return a},LogOut:function(e){e.commit;var t=e.state;return Object(u["b"])(),r.a.remove("logintoken"),t.isLogin=!0,new Promise((function(e,t){Object(s["d"])().then((function(t){e()})).catch((function(e){t(e)}))}))}}},m=f,p={state:{sectorArr:[],positionArr:[],positionId:[],deviceArr:[],positionDetail:null,currentPositionId:"",deviceType:[]},mutations:{SET_SECTORARR:function(e,t){e.sectorArr=t},SET_POSITIONARR:function(e,t){e.positionArr=t},SET_POSITIONID:function(e,t){e.positionId=t},SET_DEVICEARR:function(e,t){e.deviceArr=t},SET_POSITIONDETAIL:function(e,t){e.positionDetail=t},SET_CHECKPOSITIONID:function(e,t){e.currentPositionId=t},SET_DEVICETYPE:function(e,t){e.deviceType=t}}},w=p,h={state:{serverWs:null,serverdata:null,uavListArr:[],uavListAll:[],notificationList:[],heatBeatList:[],wsMsgStatus:{heartbeat:!1,workmode:!1,findTarget:!1,locus:!1,push_orient:!1,jamminResult:!1,push_img:!1,carLocation:!1}},mutations:{SET_SERVERWS:function(e,t){e.serverWs=t},SET_SERVERDATA:function(e,t){var n=m.state.isLogin;e.serverdata=n?t:{data:{}}},SET_UAVLISTARR:function(e,t){e.uavListArr=t},SET_UVALISTALL:function(e,t){e.uavListAll=t},SET_NOTIFICATION:function(e,t){e.notificationList=t},SET_HEATBEATLIST:function(e,t){e.heatBeatList=t}}},g=h,y={state:{autoset:!1,interstrike:!1,electronicfence:!0,showtrack:!0,radarsim:!0,equipmentmode:!0,whitePopup:!1,whiteListData:[],doStatusShow:!1,dateViewShow:!0,expelAnimate:!1,forcedAnimate:!1},mutations:{SET_AUTOSET:function(e,t){e.autoset=t},SET_INTERSTRIKE:function(e,t){e.interstrike=t},SET_ELECTRONICFENCE:function(e,t){e.electronicfence=t},SET_SHOWTRACK:function(e,t){e.showtrack=t},SET_RADARSIM:function(e,t){e.radarsim=t},SET_EQUIPMENTMODE:function(e,t){e.equipmentmode=t},SET_WHITEPOPUP:function(e,t){e.whitePopup=t},SET_WHITELISTDATA:function(e,t){e.whiteListData=t},SET_DOSTATUSSHOW:function(e,t){e.doStatusShow=t},SET_DATEVIEWSHOW:function(e,t){e.dateViewShow=t},SET_EXPELANIMATE:function(e,t){e.expelAnimate=t},SET_FORCEDANIMATE:function(e,t){e.forcedAnimate=t}}},v=y,b={state:{unusual:"",hourly:"",freq:""},mutations:{SET_UNUSUAL:function(e,t){e.unusual=t},SET_HOURLY:function(e,t){e.hourly=t},SET_FREQ:function(e,t){e.freq=t}}},k=b,T={userId:function(e){return e.user.userId},isLogin:function(e){return e.user.isLogin},isFull:function(e){return e.user.isFull},disabledState:function(e){return e.user.disabledState},serverWs:function(e){return e.websocket.serverWs},serverdata:function(e){return e.websocket.serverdata},uavListArr:function(e){return e.websocket.uavListArr},uavListAll:function(e){return e.websocket.uavListAll},notificationList:function(e){return e.websocket.notificationList},heatBeatList:function(e){return e.websocket.heatBeatList},wsMsgStatus:function(e){return e.websocket.wsMsgStatus},sectorArr:function(e){return e.sector.sectorArr},positionId:function(e){return e.sector.positionId},positionArr:function(e){return e.sector.positionArr},deviceArr:function(e){return e.sector.deviceArr},positionDetail:function(e){return e.sector.positionDetail},currentPositionId:function(e){return e.sector.currentPositionId},deviceType:function(e){return e.sector.deviceType},autoset:function(e){return e.setting.autoset},interstrike:function(e){return e.setting.interstrike},electronicfence:function(e){return e.setting.electronicfence},showtrack:function(e){return e.setting.showtrack},radarsim:function(e){return e.setting.radarsim},equipmentmode:function(e){return e.setting.equipmentmode},whitePopup:function(e){return e.setting.whitePopup},whiteListData:function(e){return e.setting.whiteListData},doStatusShow:function(e){return e.setting.doStatusShow},dateViewShow:function(e){return e.setting.dateViewShow},expelAnimate:function(e){return e.setting.expelAnimate},forcedAnimate:function(e){return e.setting.forcedAnimate},unusual:function(e){return e.monitor.unusual},hourly:function(e){return e.monitor.hourly},freq:function(e){return e.monitor.freq}},E=T;a["default"].use(i["a"]);t["a"]=new i["a"].Store({state:{},mutations:{},actions:{},modules:{user:m,websocket:g,sector:w,setting:v,monitor:k},getters:E})},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("2b0e"),i=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},o=[],r={data:function(){return{timeOut:18e5,lastTimeStoreId:"lastTime_jc"}},mounted:function(){},methods:{listenPage:function(){var e=this;this.$nextTick((function(){setInterval(this.checkTimeout,3e4)})),window.onload=function(){window.document.onmousedown=function(){e.setLastTime()},window.document.onkeydown=function(){e.setLastTime()},window.document.onmousemove=function(){e.setLastTime()}}},setLastTime:function(){localStorage.setItem(this.lastTimeStoreId,(new Date).getTime())},getLastTime:function(){return localStorage.getItem(this.lastTimeStoreId)},checkTimeout:function(){var e=(new Date).getTime(),t=this.getLastTime();e-t>this.timeOut&&(this.$router.go(0),this.setLastTime())}}},c=r,s=(n("8e21"),n("0c7c")),u=Object(s["a"])(c,i,o,!1,null,null,null),d=u.exports,l=n("323e"),f=n.n(l),m=(n("d3b7"),n("3ca3"),n("ddb0"),n("8c4f"));a["default"].use(m["a"]);var p=[{path:"/",name:"index",component:function(){return Promise.all([n.e("chunk-1114143e"),n.e("chunk-0f16cdb2"),n.e("chunk-0f8a37f6")]).then(n.bind(null,"1e4b"))}},{path:"/place",name:"index",component:function(){return n.e("chunk-1114143e").then(n.bind(null,"fbd0"))}},{path:"/dataManage",name:"index",component:function(){return Promise.all([n.e("chunk-1114143e"),n.e("chunk-0f16cdb2")]).then(n.bind(null,"313ee"))}}],w=new m["a"]({mode:"hash",routes:p}),h=w,g=n("4360"),y=n("5f87");n("a5d8");f.a.configure({showSpinner:!1}),h.beforeEach((function(e,t,n){f.a.start(),n(),Object(y["b"])(),Object(y["a"])()?(n(),f.a.done()):n()})),h.afterEach((function(){f.a.done()}));n("a262");var v=n("313e"),b=n("d4ec"),k=n("bee2"),T=(n("bf19"),function(){function e(t,n){Object(b["a"])(this,e),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"addMap3d",value:function(e,t){return new window.mars3d.Map(e,t)}},{key:"setMapOptions",value:function(e){}},{key:"initLayer",value:function(e,t){var n=this;window.CesiumSdk.marsRequest(e).then((function(e){n.addLayer(e,t)}))}},{key:"addLayer",value:function(e,t){var n;switch(e.id?this.removeLayer(e.id):e.id="layer_"+(new Date).getTime(),t=t||e.type,t){case"wmts":n=new window.mars3d.layer.WmtsLayer(e);break;case"image":n=new window.mars3d.layer.ImageLayer(e);break;case"geojson":n=new window.mars3d.layer.GeoJsonLayer(e);break;case"model":n=new window.mars3d.layer.ModelLayer(e);break;case"echart":n=new window.mars3d.layer.EchartsLayer(e),window.addEventListener("resize",(function(){n.resize()}));break;default:n=new window.mars3d.layer.TilesetLayer(e);break}return this._map.addLayer(n),e.id}},{key:"removeLayer",value:function(e){var t=this._map.getLayerById(e.id);t&&this._map.removeLayer(t,!0)}},{key:"showLayer",value:function(e){var t=this._map.getLayerById(e.id);t&&(t.show=!0)}},{key:"hideLayer",value:function(e){var t=this._map.getLayerById(e.id);t&&(t.show=!1)}},{key:"layerEventOn",value:function(e){var t=this._map.getLayerById(e.id)||this._layer;t&&t.on(e.types,e.callback)}},{key:"layerEventOff",value:function(e){var t=this._map.getLayerById(e.id)||this._layer;t&&t.off(e.types)}},{key:"changeLayer",value:function(e){var t=this._map.getLayerById(e.id);t&&(clearTimeout(window.canrefresh),window.canrefresh=setTimeout((function(){t.setOptions(option)}),500))}},{key:"layerToJson",value:function(e){var t=this._map.getLayerById(e.id),n=t.toJSON();return n}},{key:"initGeoJson",value:function(e){var t=this;window.CesiumSdk.marsRequest(e).then((function(e){t.addGeoJson(e)}))}},{key:"addGeoJson",value:function(e){e.id?this.removeLayer(e.id):e.id=(new Date).getTime();var t=new window.mars3d.layer.GeoJsonLayer(e);return this._map.addLayer(t),e.id}}]),e}()),E=(n("99af"),n("b680"),n("53ca")),_=(n("fb6a"),n("e9c4"),n("b64b"),n("bc3a")),S=n.n(_);S.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";var L=S.a.create({timeout:1e4});function O(e){for(var t="",n=0,a=Object.keys(e);n<a.length;n++){var i=a[n],o=e[i],r=encodeURIComponent(i)+"=";if(null!==o&&"undefined"!==typeof o)if("object"===Object(E["a"])(o))for(var c=0,s=Object.keys(o);c<s.length;c++){var u=s[c];if(null!==o[u]&&"undefined"!==typeof o[u]){var d=i+"["+u+"]",l=encodeURIComponent(d)+"=";t+=l+encodeURIComponent(o[u])+"&"}}else t+=r+encodeURIComponent(o)+"&"}return t}L.interceptors.request.use((function(e){if("get"===e.method&&e.params){var t=e.url+"?"+O(e.params);t=t.slice(0,-1),e.params={},e.url=t}if("post"===e.method||"put"===e.method)e.url,"object"===Object(E["a"])(e.data)?JSON.stringify(e.data):e.data,(new Date).getTime();return e}),(function(e){Promise.reject(e)}));var C,x=function(){function e(t,n){Object(b["a"])(this,e),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"getCenter",value:function(){return this._map.getCenter()}},{key:"lngLatPoint",value:function(e,t,n){return new window.mars3d.LngLatPoint(e,t,n)}},{key:"pointToCartesian3",value:function(e,t,n){return new window.cesium.Cartesian3(e,t,n)}},{key:"cartesian3ToPoint",value:function(e){return window.mars3d.LngLatPoint.fromCartesian(e)}},{key:"request",value:function(e){return new Promise((function(t){L(e).then((function(e){t(e)}))}))}}]),e}(),A=new x,I=function(){function e(t,n){Object(b["a"])(this,e),console.log("map,layer",t,n),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"removeModel",value:function(e){var t=this._layer.getGraphicById(e.id);console.log(t),this._layer.removeGraphic(t)}},{key:"setDynamicPosition",value:function(e){var t=this._layer.getGraphicById(e.id);t.addDynamicPosition(t.point),t.addDynamicPosition(A.lngLatPoint(e.lng,e.lat,e.alt),e.time)}},{key:"addUAV",value:function(e){var t="经度：".concat(e.lng.toFixed(6),"°\n纬度：").concat(e.lat.toFixed(6),"°\n高度：").concat(e.alt.toFixed(0),"米"),n=(new Date).getTime();e.id=e.id||n;var a=new window.mars3d.graphic.ModelEntity({id:e.id,position:[e.lng,e.lat,e.alt],type:"UAV",style:{url:location.origin+"/data/uav.gltf",scale:e.scale||.5,minimumPixelSize:160,silhouette:!1,label:{text:t,font:"12px/1.5 system-ui",pixelOffset:new window.cesium.Cartesian2(30,0),pixelOffsetScaleByDistance:new window.cesium.NearFarScalar(100,2,5e7,.1),style:window.cesium.LabelStyle.FILL_AND_OUTLINE,fillColor:window.cesium.Color.WHITE,outlineColor:window.cesium.Color.BLACK,outlineWidth:1,showBackground:!0,backgroundColor:new window.cesium.Color(0,0,0,.3),backgroundPadding:new window.cesium.Cartesian2(5,5),verticalOrigin:window.cesium.VerticalOrigin.CENTER,horizontalOrigin:window.cesium.HorizontalOrigin.LEFT,scaleByDistance:new window.cesium.NearFarScalar(100,2,5e7,.1)}}});return this._layer.addGraphic(a),console.log("options",e.id),e.id}},{key:"updateUAV",value:function(e){var t=this._layer.getGraphicById(e.id);if(null!=t){var n=t.options;e.lng&&e.lat&&e.alt&&(n.position=[e.lng,e.lat,e.alt],n.style.label.text=new window.cesium.CallbackProperty((function(){return"经度：".concat(e.lng.toFixed(6),"°\n纬度：").concat(e.lat.toFixed(6),"°\n高度：").concat(e.alt.toFixed(0),"米")}),!1).getValue()),e.scale&&(n.style.scale=e.scale),t.setOptions(n)}}},{key:"addRadar",value:function(e){e.id=e.id||(new Date).getTime();var t=new window.mars3d.graphic.EllipsoidEntity({id:e.id,position:[e.lng,e.lat,e.alt],style:{radii:e.radius,maximumConeDegree:90,material:mars3d.MaterialUtil.createMaterialProperty(mars3d.MaterialType.EllipsoidWave,{color:e.color||"#00ffff",speed:5}),outline:!0,outlineColor:window.cesium.Color.WHITE.withAlpha(.3)}});return t.addScanPlane({type:"heading",step:.5}),this._layer.addGraphic(t),e.id}},{key:"updateRadar",value:function(e){var t=this._layer.getGraphicById(e.id);null!=t&&(t.removeAllScanPlan(),t.position=[e.lng,e.lat,e.alt],e.radius&&(t.options.style.radii=e.radius),t.addScanPlane({type:"heading",step:.5}))}},{key:"addCylinder",value:function(e){e=e||{},e.id=e.id||(new Date).getTime();var t=window.mars3d,n=new t.graphic.CylinderPrimitive({id:e.id,position:[e.lng,e.lat,e.alt],style:{length:e.length||9e3,topRadius:e.topRadius||0,bottomRadius:e.bottomRadius||3e3,material:t.MaterialUtil.createMaterial(t.MaterialType.CircleWave,{color:e.color||"#02ff00"})}});return this._layer.addGraphic(n),e.id}},{key:"addOutCircle",value:function(){for(var e=[{image:"http://mars3d.cn/img/icon/calib.png",positions:[[104.41662051312065,33.49737321287804],[111.11441505143736,26.799578674450764]]},{image:"http://mars3d.cn/img/icon/calib-value.png",positions:[[104.62935661723176,33.28444860549337],[110.90123858756024,27.012566635061315]]},{image:"http://mars3d.cn/img/icon/calib-dir.png",positions:[[104.93938425401629,32.97468816443797],[110.5910688483037,27.323003570057217]]}],t=0;t<e.length;t++){var n=e[t],a=new window.mars3d.graphic.RectanglePrimitive({positions:n.positions,style:{materialType:window.mars3d.MaterialType.Image2,image:n.image,opacity:.4}});this._layer.addGraphic(a)}}},{key:"addBorderWall",value:function(e){e=e||{};var t=[[106.65553865659828,29.883458651621645],[106.65553865659828,29.884414829138695],[106.70894441576242,29.867202227041176],[106.67927455381748,29.791623271742708],[106.68944707900722,29.780137974585525],[106.69961960419832,29.750461601421744],[106.69707647098464,29.732268553522406],[106.69622876502251,29.720776524229095],[106.69453333777213,29.715030021303075],[106.691990212221,29.693956732619476],[106.67673142060382,29.667129856260924],[106.66571118178818,29.657547116826006],[106.63943215901904,29.649880273249387],[106.63095505341707,29.56838438195206],[106.62671650061549,29.57030267815913],[106.62671650061549,29.56838438195206],[106.57161531419989,29.590442639714766],[106.60213289743425,29.661380326617877],[106.58517868622795,29.68629263490406],[106.58094013342767,29.701620251985936],[106.58941723903072,29.756206087027373],[106.59450349779328,29.77056590403094],[106.60213289743425,29.78396655497174],[106.61315312858623,29.793537358035113],[106.61400084221196,29.793537358035113],[106.61739168138776,29.796408419557324],[106.63010733979128,29.80310725553291],[106.64027986498238,29.80502113387327],[106.65214781742256,29.884414829138695],[106.65553865659828,29.883458651621645]],n=new window.mars3d.graphic.ScrollWall({id:e.id,positions:e.positions||t,style:{diffHeight:e.diffHeight||1e5,color:e.color||"#ff0000",speed:e.speed||10,reverse:!!e.speed}});this._layer.addGraphic(n)}}]),e}(),j=function(){function e(t,n){Object(b["a"])(this,e),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"bindMapMenu",value:function(e){console.log(this._map);var t=e||this._map.getDefaultContextMenu();console.log("contextmenuItems",t),this._map.bindContextMenu(t)}},{key:"unBindMapMenu",value:function(){this._map.unbindContextMenu()}},{key:"bindLayerMenu",value:function(e,t){e=e||this._layer,console.log("graphicLayer",e),t=t||[{text:"开始编辑对象",icon:"fa fa-edit",show:function(e){var t=e.graphic;return!(!t||!t.startEditing)&&!t.isEditing},callback:function(t){var n=t.graphic;if(!n)return!1;n&&e.startEditing(n)}},{text:"停止编辑对象",icon:"fa fa-edit",show:function(e){var t=e.graphic;return!!t&&t.isEditing},callback:function(t){var n=t.graphic;if(!n)return!1;n&&e.stopEditing(n)}},{text:"删除对象",icon:"fa fa-trash-o",callback:function(t){var n=t.graphic;n&&e.removeGraphic(n)}},{text:"计算长度",icon:"fa fa-medium",show:function(e){var t=e.graphic;return"scrollWall"===t.type||"polyline"===t.type||"curve"===t.type||"polylineVolume"===t.type||"corridor"===t.type||"wall"===t.type},callback:function(e){var t=e.graphic,n=mars3d.MeasureUtil.formatDistance(t.distance);alert("该对象的长度为:"+n)}},{text:"计算周长",icon:"fa fa-medium",show:function(e){var t=e.graphic;return"circle"===t.type||"rectangle"===t.type||"polygon"===t.type},callback:function(e){var t=e.graphic,n=mars3d.MeasureUtil.formatDistance(t.distance);alert("该对象的周长为:"+n)}},{text:"计算面积",icon:"fa fa-reorder",show:function(e){var t=e.graphic;return"circle"===t.type||"rectangle"===t.type||"polygon"===t.type},callback:function(e){var t=e.graphic,n=mars3d.MeasureUtil.formatArea(t.area);alert("该对象的面积为:"+n)}}],e.bindContextMenu(t)}},{key:"unBindLayerMenu",value:function(e){e=e||this._layer,e.unbindContextMenu()}},{key:"bindGraphicMenu",value:function(e){e.bindContextMenu([{text:"删除graphic对象",icon:"fa fa-trash-o",callback:function(e){var t=e.graphic;t&&t.remove()}}])}},{key:"unBindGraphicMenu",value:function(e){e.unbindContextMenu()}}]),e}(),P=new x,D=function(){function e(t,n){Object(b["a"])(this,e),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"startMapRotate",value:function(e){var t=this;this.stopMapRotate(),window.CesiumSdk.mapRotateFn=function(){t.mapRotate(e)},this._map.on(window.mars3d.EventType.clockTick,window.CesiumSdk.mapRotateFn)}},{key:"stopMapRotate",value:function(){this._map.off(window.mars3d.EventType.clockTick,window.CesiumSdk.mapRotateFn)}},{key:"mapRotate",value:function(e){var t,n;console.log(Object(E["a"])(e)),t=window.cesium.Cartesian3.UNIT_Z,null!==e&&"object"===Object(E["a"])(e)&&(n=e.speed,e.lng&&e.lat&&e.alt&&(t=P.pointToCartesian3(e.lng,e.lat,e.alt))),this._map.camera.rotate(t,n)}},{key:"setCameraViewList",value:function(e){var t=[{lng:108.961601,lat:34.217109,alt:509.2,heading:314.5,pitch:-22.5,duration:8,stop:0},{lng:108.96164,lat:34.222159,alt:510.3,heading:211.2,pitch:-22.5,duration:5,stop:0},{lng:108.957259,lat:34.221967,alt:494.3,heading:127.5,pitch:-17.2,duration:5,stop:0},{lng:108.957319,lat:34.217225,alt:515.5,heading:25.4,pitch:-25.3,duration:5}];e=e||t,this._map.setCameraViewList(e)}},{key:"createRotatePoint",value:function(e){var t={direction:!1,time:50};e=e||t,window.rotatePoint=new window.mars3d.thing.RotatePoint(e),this._map.addThing(window.rotatePoint),window.rotatePoint.start()}},{key:"stratRotatePoint",value:function(e){if(window.rotatePoint){var t=this._map.getCenter();null!==e&&"object"===Object(E["a"])(e)&&e.lng&&e.lat&&e.alt&&(t=P.lngLatPoint(e.lng,e.lat,e.alt)),window.rotatePoint.start(t)}else this.createRotatePoint()}},{key:"stopRotatePoint",value:function(){window.rotatePoint&&window.rotatePoint.stop()}},{key:"flyHome",value:function(e){this._map.flyHome(e)}},{key:"flyToPoint",value:function(e){if(null!==e&&"object"===Object(E["a"])(e)&&e.lng&&e.lat&&e.alt){var t=P.lngLatPoint(e.lng,e.lat,e.alt);delete e.lng,delete e.lat,delete e.alt,this._map.flyToPoint(t,e)}}},{key:"flyToLayer",value:function(e){var t=this._map.getLayerById(e.id);delete e.id,t.flyTo(e)}}]),e}(),R=n("5530"),M=n("15fd"),B=(n("159b"),n("d81d"),n("7db0"),n("b0c0"),["baseURL","url","type","method","requestParams","start_time","end_time","device_id","rule_id"]),F=new x,U=function(){function e(t,n){Object(b["a"])(this,e),this._map=t,this._layer=n}return Object(k["a"])(e,[{key:"showEffect",value:function(e){var t,n;switch(e=e||{},e.type){case"fog":t=window.fogEffect;break;case"rain":t=window.rainEffect;break;case"snow":t=window.fogEffect,n=window.snowCover;break;default:window.fogEffect?window.fogEffect.enabled=!0:window.rainEffect?window.rainEffect.enabled=!0:window.snowEffect&&window.snowCover&&(window.snowEffect.enabled=!0,window.snowCover.enabled=!0);break}t&&(t.enabled=!0),n&&(n.enabled=!0)}},{key:"hideEffect",value:function(e){var t,n;switch(e=e||{},e.type){case"fog":t=window.fogEffect;break;case"rain":t=window.rainEffect;break;case"snow":t=window.snowEffect,n=window.snowCover;break;default:window.fogEffect&&(window.fogEffect.enabled=!1),window.rainEffect&&(window.rainEffect.enabled=!1),window.snowEffect&&window.snowCover&&(window.snowEffect.enabled=!1,window.snowCover.enabled=!1);break}t&&(t.enabled=!1),n&&(n.enabled=!1)}},{key:"addFogEffect",value:function(e){e=e||{};var t={maxHeight:2e4,fogByDistance:new window.cesium.Cartesian4(e.near||100,0,e.far||1e3,.9),color:window.cesium.Color.fromCssColorString(e.color||"#FFFFFF")};window.fogEffect=new window.mars3d.effect.FogEffect(t),this._map.addEffect(window.fogEffect)}},{key:"updateFogEffect",value:function(e){e=e||{};var t=window.fogEffect;t&&(e.color&&(t.color=Cesium.Color.fromCssColorString(e.color)),e.near&&(t.fogByDistance.x=e.near),e.far&&(t.fogByDistance.x=e.far))}},{key:"addRainEffect",value:function(e){e=e||{},window.rainEffect=new window.mars3d.effect.RainEffect({speed:e.speed||10,size:e.speed||20,direction:e.speed||-30}),this._map.addEffect(window.effect)}},{key:"updateRainEffect",value:function(e){e=e||{};var t=window.rainEffect;t&&(e.speed&&(t.speed=e.speed),e.size&&(t.size=e.size),e.direction&&(t.direction=e.direction))}},{key:"addSnowEffect",value:function(e){e=e||{},window.snowEffect=new mars3d.effect.SnowEffect({speed:e.speed||20}),this._map.addEffect(window.snowEffect),window.snowCover=new mars3d.effect.SnowCoverEffect({maxHeight:8e3,alpha:e||.6}),this._map.addEffect(window.snowCover)}},{key:"updateSnowEffect",value:function(e){e=e||{};var t=window.snowEffect,n=window.snowCover;t&&(e.speed&&(t.speed=e.speed),e.size&&(n.alpha=e.alpha))}},{key:"drawChartByType",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.baseURL,a=void 0===n?"http://192.168.3.11:5799":n,i=t.url,o=t.type,r=t.method,c=void 0===r?"get":r,s=t.requestParams,u=void 0===s?{}:s,d=t.start_time,l=void 0===d?"2020-01-01":d,f=t.end_time,m=void 0===f?"2021-07-01":f,p=t.device_id,w=void 0===p?"1090103001000234":p,h=t.rule_id,g=void 0===h?"1040103001000105":h,y=Object(M["a"])(t,B);i="/api/shared/DeviceData/dynamic/count/year","DeviceData_year"===o?i="/api/shared/DeviceData/dynamic/count/year":"DeviceData_month"===o?i="/api/shared/DeviceData/dynamic/count/month":"DeviceData_day"===o?i="/api/shared/DeviceData/dynamic/count/day":"DeviceData_azimuth"===o&&(i="/api/shared/DeviceData/dynamic/count/azimuth"),F.request({url:i,baseURL:a,method:c,params:Object(R["a"])({start_time:l,end_time:m,device_id:w,rule_id:g},u)}).then((function(n){if(0==n.data.code){var a=n.data.data;if(console.log("data",a,o),"DeviceData_azimuth"===o){if(n.data.data.length){var i=["北","西北","西","西南","南","东南","东","东北"],r=10;a.forEach((function(e){var t=Math.max.apply(null,e.data.map((function(e){return e.count})));r=t>t?t:r}));var c=i.map((function(e){return{text:e,max:r}})),s=[{type:"radar",tooltip:{trigger:"item"},areaStyle:{},data:a.map((function(e){return{name:e.event_name,value:i.map((function(t){return e.data.find((function(e){return e.name=t})).count}))}}))}],u=Object(R["a"])({id:t.id,animation:!1,radar:{indicator:c,center:["25%","40%"],radius:80},legend:{data:a.map((function(e){return e.event_name})),left:"20%",top:"25%",textStyle:{color:"#fff"}},series:s},y);e.drawChart(u)}}else{a.series.forEach((function(e){e.type="bar",e.data=e.data.map((function(e,t){return{name:a.xAxis[t],value:e}}))}));var d=Object(R["a"])({id:t.id,animation:!1,tooltip:{trigger:"item"},grid:{right:40,top:100,bottom:40,width:"30%"},xAxis:{type:"category",nameGap:16,axisLine:{show:!0,lineStyle:{color:"#fff"}},axisTick:{lineStyle:{color:"#fff"}},axisLabel:{interval:0,color:"#fff"},data:a.xAxis},legend:{data:a.series.map((function(e){return e.name})),right:150,textStyle:{color:"#fff"}},yAxis:{type:"value",scale:!0,position:"top",boundaryGap:!1,splitLine:{show:!0},axisTick:{show:!0},axisLabel:{margin:2,color:"#fff"}},series:a.series},y);e.drawChart(d)}}}))}},{key:"drawChart",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.id=e.id||(new Date).getTime(),console.log(JSON.stringify(e));var t=new window.mars3d.layer.EchartsLayer(e);return t.pointerEvents=!1,this._map.addLayer(t),e.id}},{key:"removeChart",value:function(e){var t=this._map.getLayerById(e.id);t&&this._map.removeLayer(t,!0)}}]),e}(),N=function(){function e(){Object(b["a"])(this,e),this._map=null,this._layer=null}return Object(k["a"])(e,[{key:"Map",get:function(){return this._map},set:function(e){this._map=e,this._layer=new window.mars3d.layer.GraphicLayer,this._map.addLayer(this._layer)}},{key:"marsRequest",value:function(e){return new Promise((function(t){window.mars3d.Resource.fetchJson({url:e}).then((function(e){t(e)}))}))}},{key:"Interact",value:function(e,t){return e=e||this._map,t=t||this._layer,new T(e,t)}},{key:"Model",value:function(e,t){return e=e||this._map,t=t||this._layer,new I(e,t)}},{key:"Control",value:function(e,t){return e=e||this._map,t=t||this._layer,new j(e,t)}},{key:"Camera",value:function(e,t){return e=e||this._map,t=t||this._layer,new D(e,t)}},{key:"Convert",value:function(e,t){return e=e||this._map,t=t||this._layer,new x(e,t)}},{key:"Draw",value:function(e,t){return e=e||this._map,t=t||this._layer,new U(e,t)}}]),e}(),q=n("5c96"),W=n.n(q),G=(n("0fae"),n("78a7"),n("caad"),n("2532"),n("ac1f"),n("5319"),{bind:function(e,t,n,a){var i=t.value;if(!1!==i){var o=e.querySelector(".dialog_header"),r=e;o.style.cursor="move";var c=r.currentStyle||window.getComputedStyle(r,null);r.style.position="absolute",o.onmousedown=function(e){var t,n,a=e.clientX-o.offsetLeft,i=e.clientY-o.offsetTop;c.left.includes("%")?(t=+document.body.clientWidth*(+c.left.replace(/\%/g,"")/100),n=+document.body.clientHeight*(+c.top.replace(/\%/g,"")/100)):(t=+c.left.replace(/\px/g,""),n=+c.top.replace(/\px/g,"")),document.body.style.userSelect="none",document.onmousemove=function(e){var o=e.clientX-a,c=e.clientY-i,s=o+t,u=c+n;r.style.left="".concat(s,"px"),r.style.top="".concat(u,"px")},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}}}),H={msg:function(e){q["Message"].info(e)},msgError:function(e){q["Message"].error(e)},msgSuccess:function(e){q["Message"].success(e)},msgWarning:function(e){q["Message"].warning(e)},alert:function(e){q["MessageBox"].alert(e,"系统提示")},alertError:function(e){q["MessageBox"].alert(e,"系统提示",{type:"error"})},alertSuccess:function(e){q["MessageBox"].alert(e,"系统提示",{type:"success"})},alertWarning:function(e){q["MessageBox"].alert(e,"系统提示",{type:"warning"})},notify:function(e){q["Notification"].info(e)},notifyError:function(e){q["Notification"].error(e)},notifySuccess:function(e){q["Notification"].success(e)},notifyWarning:function(e){q["Notification"].warning(e)},confirm:function(e){return q["MessageBox"].confirm(e,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},prompt:function(e){return q["MessageBox"].prompt(e,"系统提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},loading:function(e){C=q["Loading"].service({lock:!0,text:e,spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"})},closeLoading:function(){C.close()}},V={install:function(e){e.prototype.$modal=H}};a["default"].use(W.a),a["default"].use(V),a["default"].prototype.$echarts=v,a["default"].config.productionTip=!1,a["default"].prototype.$bus=new a["default"],window.CesiumSdk=new N,window.cesium=window.mars3d.Cesium,a["default"].directive("dialogDrag",G),new a["default"]({router:h,store:g["a"],render:function(e){return e(d)}}).$mount("#app")},"5f87":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return s}));var a=n("a78e"),i=n.n(a),o="System-Token";function r(){return i.a.get(o)}function c(e){return i.a.set(o,e)}function s(){return i.a.remove(o)}},"60b4":function(e,t,n){},"78a7":function(e,t,n){},"7ded":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return u}));var a=n("a78e"),i=n.n(a),o=n("b775");function r(e,t,n){var a={username:e,password:t,type:n};return Object(o["a"])({url:"/Token/Login",method:"post",headers:{isToken:!1},data:a})}function c(){return Object(o["a"])({url:"/Token/Access",headers:{isToken:!1,Authorization:"Bearer ".concat(i.a.get("logintoken"))},method:"post"})}function s(){return Object(o["a"])({url:"/Token/Logout",method:"post",headers:{isToken:!1,Authorization:"Bearer ".concat(i.a.get("logintoken"))}})}function u(e){return Object(o["a"])({url:"/User/email",method:"get",params:e,request_base:"authority"})}},"8e21":function(e,t,n){"use strict";n("60b4")},a262:function(e,t,n){n("ac1f"),n("466d"),n("b680"),function(e,t){var n,a=e.document,i=a.documentElement,o=a.querySelector('meta[name="viewport"]'),r=a.querySelector('meta[name="flexible"]'),c=0,s=0,u=t.flexible||(t.flexible={});if(o){console.warn("将根据已有的meta标签来设置缩放比例");var d=o.getAttribute("content").match(/initial\-scale=([\d\.]+)/);d&&(s=parseFloat(d[1]),c=parseInt(1/s))}else if(r){var l=r.getAttribute("content");if(l){var f=l.match(/initial\-dpr=([\d\.]+)/),m=l.match(/maximum\-dpr=([\d\.]+)/);f&&(c=parseFloat(f[1]),s=parseFloat((1/c).toFixed(2))),m&&(c=parseFloat(m[1]),s=parseFloat((1/c).toFixed(2)))}}if(!c&&!s){e.navigator.appVersion.match(/android/gi);var p=e.navigator.appVersion.match(/iphone/gi),w=e.devicePixelRatio;c=p?w>=3&&(!c||c>=3)?3:w>=2&&(!c||c>=2)?2:1:1,s=1/c}if(i.setAttribute("data-dpr",c),!o)if(o=a.createElement("meta"),o.setAttribute("name","viewport"),o.setAttribute("content","initial-scale="+s+", maximum-scale="+s+", minimum-scale="+s+", user-scalable=no"),i.firstElementChild)i.firstElementChild.appendChild(o);else{var h=a.createElement("div");h.appendChild(o),a.write(h.innerHTML)}function g(){var t=i.getBoundingClientRect().width;t/c<1660?t=1660*c:t/c>2560&&(t=2560*c);var n=t/24;i.style.fontSize=n+"px",u.rem=e.rem=n}e.addEventListener("resize",(function(){clearTimeout(n),n=setTimeout(g,300)}),!1),e.addEventListener("pageshow",(function(e){e.persisted&&(clearTimeout(n),n=setTimeout(g,300))}),!1),"complete"===a.readyState?a.body.style.fontSize=12*c+"px":a.addEventListener("DOMContentLoaded",(function(e){a.body.style.fontSize=12*c+"px"}),!1),g(),u.dpr=e.dpr=c,u.refreshRem=g,u.rem2px=function(e){var t=parseFloat(e)*this.rem;return"string"===typeof e&&e.match(/rem$/)&&(t+="px"),t},u.px2rem=function(e){var t=parseFloat(e)/this.rem;return"string"===typeof e&&e.match(/px$/)&&(t+="rem"),t}}(window,window["lib"]||(window["lib"]={}))},b775:function(e,t,n){"use strict";n("99af"),n("fb6a"),n("d3b7"),n("caad"),n("2532");var a=n("bc3a"),i=n.n(a),o=n("5c96"),r=n("4360"),c=n("5f87"),s=n("ed08"),u=window.config.baseUrl;i.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";var d=i.a.create({baseURL:u,timeout:1e4});d.interceptors.request.use((function(e){e.baseURL=window.config[e.request_base]||u;var t=e.headers||{},n=t.isToken;if(Object(c["a"])()&&!n&&(e.headers.Authorization="Bearer ".concat(Object(c["a"])())),e.params){var a="".concat(e.url,"?").concat(Object(s["c"])(e.params));a=a.slice(0,-1),e.params={},e.url=a}return e}),(function(e){Promise.reject(e)})),d.interceptors.response.use((function(e){var t=e.data;t.code,t.msg;return"blob"===e.request.responseType||"arraybuffer"===e.request.responseType?e.data:200===e.status||0===e.data.code?Promise.resolve(e.data):-2!==e.data.code?Promise.reject(e):void Object(s["a"])(e.data.data,r["a"].state.setting.doStatusShow)}),(function(e){var t=e.config,n=e.response,a=e.message;return n&&(401!==n.status&&472!==n.status&&471!==n.status||"/Token/Logout"===t.url&&"/Token/Access"===t.url||o["MessageBox"].confirm("登录状态已过期，您可以继续留在该页面，或者重新登录","系统提示",{confirmButtonText:"重新登录",cancelButtonText:"取消",type:"warning"}).then((function(){Object(c["b"])(),r["a"].dispatch("LogOut").then((function(){}))})).catch((function(){}))),"Network Error"===a?a="后端接口连接异常":a.includes("timeout")&&(a="系统接口请求超时"),Promise.reject(e)})),t["a"]=d},ed08:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return u}));n("c7eb"),n("1da1");var a=n("53ca"),i=(n("d9e2"),n("d3b7"),n("159b"),n("b64b"),n("ac1f"),n("5319"),n("00b4"),n("4d63"),n("c607"),n("2c3e"),n("25f0"),n("99af"),n("5c96")),o=n("4360");function r(e,t){if(0===arguments.length||!e)return null;var n,i=t||"{y}-{m}-{d} {h}:{i}:{s}";"object"===Object(a["a"])(e)?n=e:("string"===typeof e&&/^[0-9]+$/.test(e)?e=parseInt(e):"string"===typeof e&&(e=e.replace(new RegExp(/-/gm),"/").replace("T"," ").replace(new RegExp(/\.[\d]{3}/gm),"")),"number"===typeof e&&10===e.toString().length&&(e*=1e3),n=new Date(e));var o={y:n.getFullYear(),m:n.getMonth()+1,d:n.getDate(),h:n.getHours(),i:n.getMinutes(),s:n.getSeconds(),a:n.getDay()},r=i.replace(/{(y|m|d|h|i|s|a)+}/g,(function(e,t){var n=o[t];return"a"===t?["日","一","二","三","四","五","六"][n]:(e.length>0&&n<10&&(n="0".concat(n)),n||0)}));return r}function c(e){for(var t="",n=0,i=Object.keys(e);n<i.length;n++){var o=i[n],r=e[o],c="".concat(encodeURIComponent(o),"=");if(null!==r&&"undefined"!==typeof r)if("object"===Object(a["a"])(r))for(var s=0,u=Object.keys(r);s<u.length;s++){var d=u[s];if(null!==r[d]&&"undefined"!==typeof r[d]){var l="".concat(o,"[").concat(d,"]"),f="".concat(encodeURIComponent(l),"=");t+="".concat(f+encodeURIComponent(r[d]),"&")}}else t+="".concat(c+encodeURIComponent(r),"&")}return t}function s(e,t,n){console.log(t,n,"coutTime"),setTimeout((function(){-1==e?n=!1:(t.message="操作正在被更高级别用户占用，请等待".concat(e,"秒"),s(--e,t,n)),o["a"].commit("SET_DOSTATUSSHOW",n)}),1e3)}function u(e,t){console.log(t,"show"),t=!0;var n=Object(i["Message"])({message:"操作正在被更高级别用户占用，请等待".concat(e,"秒"),type:"error",duration:"".concat(e,"000")});e--,s(e,n,t)}}});
//# sourceMappingURL=app.4c790e4a.js.map